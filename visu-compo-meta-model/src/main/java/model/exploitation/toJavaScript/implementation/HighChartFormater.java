package model.exploitation.toJavaScript.implementation;

import model.exploitation.toJavaScript.metaclasse.ElementInstance;
import model.exploitation.toJavaScript.interfaces.DataTargetFormater;
import model.exploitation.toJavaScript.metaclasse.VisualizationInstance;

/**
 * Created by Ivan Logre on 01/07/2014.
 */
public class HighChartFormater implements DataTargetFormater {


    @Override
    public String convertData2LibraryFormat(VisualizationInstance vi) {
        //transform the hashmap(time,value) in a format understandable by AmChart
        StringBuilder dataToPrint = new StringBuilder();
        dataToPrint.append("[");
        dataToPrint.append("\n");

        while(!vi.isEmpty()){
            ElementInstance first = vi.getFirstIndex();

            dataToPrint.append("[");
            dataToPrint.append("\""+first.getValue().toString()+"\"");

            for(ElementInstance ei : first.getValues()){
                dataToPrint.append(",");
                dataToPrint.append(ei.getValue());
            }
            dataToPrint.append("],");
            dataToPrint.append("\n");

            first.getResourceInstance().removeKey(first);
        }

        dataToPrint.deleteCharAt(dataToPrint.lastIndexOf(","));
        dataToPrint.append("\n");
        dataToPrint.append("]");

        return dataToPrint.toString();
    }

    @Override
    public String convertTimedData2LibraryFormat(VisualizationInstance vi) {
        return null;
    }
}
